<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>提示框</title>
  <link rel="stylesheet"  href="./geomap-api/JsCodeDemo_new/css/mapbox-gl.css" />
  <script src="./geomap-api/JsCodeDemo_new/js/mapbox-gl.js"></script>
  <script src="./geomap-api/JsCodeDemo_new/js/GeoGlobeJS.min.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
    }
    html,
    body,
    #map {
      height: 100%;
    }
    #marker {
      background-image: url('./geomap-api/JsCodeDemo_new/images/0.png');
      background-size: cover;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      cursor: pointer;
    }
  </style>
</head>
<body>
<div id="map"></div>
<script>
  // 创建地图对象实例，默认坐标系为经纬度
  var map = new GeoGlobe.Map({
    mapCRS: {
      topTileExtent: [-180, -270, 180, 90],
      coordtransform: 'none'
    },
    container: 'map',
    zoom: 4,
    center: [114.41, 30.58]
  });

  // 添加天地图
  map.on('load', function(e) {
    var token = 'e90d56e5a09d1767899ad45846b0cefd';
    var layer_vtc = new GeoGlobe.TDTLayer('vec_c', token);
    var layer_cva = new GeoGlobe.TDTLayer('cva_c', token);
    map.addLayer(layer_vtc);
    map.addLayer(layer_cva);
  });

  //直接显示信息框
  var popup1 = new GeoGlobe.Popup({ closeOnClick: false })
          .setLngLat([116.41, 38.58])
          .setHTML('<h1>北京，您好!</h1>')
          .addTo(map);

  //点击图片弹出信息框
  var popup2 = new GeoGlobe.Popup({ offset: 25 }).setText(
          '郑州市区在这里！'
  );
  var el = document.createElement('div');
  el.id = 'marker';
  var monument = [113.65, 34.76];

  new GeoGlobe.Marker(el)
          .setLngLat(monument)
          .setPopup(popup2)
          .addTo(map);

  //添加点图层
  map.on('load', function() {
    //武汉点图层
    var pointjson1 = {
      type: 'geojson',
      data: {
        type: 'Feature',
        geometry: {
          type: 'Point',
          coordinates: [114.31, 30.52]
        },
        properties: {
          title: 'add point',
          'marker-symbol': 'monument'
        }
      }
    };
    map.addLayer({
      id: 'point',
      type: 'circle',
      source: pointjson1,
      paint: {
        'circle-radius': 5,
        'circle-color': 'red',
        'circle-opacity': 0.8
      }
    });
    //南京点图层
    var pointjson2 = {
      type: 'geojson',
      data: {
        type: 'Feature',
        geometry: {
          type: 'Point',
          coordinates: [118.65, 32.13]
        },
        properties: {
          title: 'add point',
          'marker-symbol': 'monument'
        }
      }
    };
    map.addLayer({
      id: 'point1',
      type: 'circle',
      source: pointjson2,
      paint: {
        'circle-radius': 5,
        'circle-color': 'red',
        'circle-opacity': 0.8
      }
    });
  });

  //悬浮在武汉上弹出信息框
  var popup = new GeoGlobe.Popup({
    closeButton: true,
    closeOnClick: true
  });
  map.on('mouseenter', 'point', function(e) {
    var coordinates = e.features[0].geometry.coordinates.slice();
    while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
      coordinates[0] +=
              e.lngLat.lng > coordinates[0] ? 360 : -360;
    }
    popup
            .setLngLat(coordinates)
            .setHTML('这是武汉市区！')
            .addTo(map);
  });
  map.on('mouseleave', 'point', function() {
    map.getCanvas().style.cursor = '';
    popup.remove();
  });

  //点击南京弹出框
  map.on('mouseenter', 'point1', function(e) {
    var coordinates = e.features[0].geometry.coordinates.slice();
    while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
      coordinates[0] +=
              e.lngLat.lng > coordinates[0] ? 360 : -360;
    }
    popup
            .setLngLat(coordinates)
            .setHTML('这是南京市区！')
            .addTo(map);
  });
</script>
</body>
</html>
